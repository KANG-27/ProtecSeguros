---

const {data, type}= Astro.props

console.log(data)
console.log(type)

---

<div class="carousel" data-content={`{"tipo": "${type}", "tamaño": "${data.length}"}`}>
  <div class="carousel-inner">
    {type=="servicios" &&
      data.map((datas:any) => (
        datas.data.imagenes.map((image:string) => (
          <div class="carousel-item">
            <img src={image} alt="Carousel image" />
          </div>
        ))
      ))
    } 
    {type=="aliados" &&
      data.map((image:string) => (
        <div class="carousel-item">
          <img src={image} alt="Carousel image" />
        </div>
      ))
    } 
   
  </div>
  <div class="carousel-controls">
    <button class="control prev">❮</button>
    <button class="control next">❯</button>
  </div>
</div>

<script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function() {
    const carousels = document.querySelectorAll(".carousel");

    carousels.forEach((carousel, carouselIndex) => {
      const carouselData = JSON.parse(carousel.getAttribute("data-content"));
      let currentIndex = 0;

      function getVisibleItems() {
        if (window.innerWidth < 768) {
          return 1;
        } else if (window.innerWidth < 1024) {
          return 2;
        } else {
          return 3;
        }
      }

      function showSlide(index) {
        const slides = carousel.querySelector(".carousel-inner");
        const totalSlides = carouselData.tamaño;
        const visibleItems = getVisibleItems();

        if (index < 0) {
          currentIndex = totalSlides - visibleItems;
        } else if (index >= totalSlides) {
          currentIndex = 0;
        } else {
          currentIndex = index;
        }

        const offset = -currentIndex * (90 / visibleItems);
        slides.style.transform = `translateX(${offset}%)`;
      }

      function nextSlide() {
        showSlide(currentIndex + 1);
      }

      function prevSlide() {
        showSlide(currentIndex - 1);
      }

      // Inicializar el carrusel al cargar la página
      showSlide(0);

      // Añadir los eventos a los botones de control
      const nextButton = carousel.querySelector(".next");
      const prevButton = carousel.querySelector(".prev");

      nextButton.addEventListener("click", nextSlide);
      prevButton.addEventListener("click", prevSlide);

      // Actualizar el carrusel al cambiar el tamaño de la ventana
      window.addEventListener("resize", () => showSlide(currentIndex));
    });
  });
</script>




<style>
  .carousel {
    display: flex;
    overflow: hidden;
    width: 100%;
    position: relative;
  }

  .carousel-inner {
    display: flex;
    gap: 20px;
    align-items: center;
    transition: transform 0.5s ease;
  }

  .carousel-item {
    box-sizing: border-box;
    /* border-radius: 10%; */
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: white;
    height: 100%;
  }

  .carousel img {
    width: 60%;
    height: auto;
  }

  .carousel-controls {
    position: absolute;
    top: 50%;
    width: 100%;
    display: flex;
    justify-content: space-between;
    transform: translateY(-50%);
  }

  .control {
    background: rgba(255, 255, 255, 0.7);
    border: none;
    padding: 10px;
    cursor: pointer;
  }

  @media (max-width: 768px) {
    .carousel-item {
      min-width: 90%; /* Mostrar 1 imagen en pantallas pequeñas */
    }
  }

  @media (min-width: 768px) and (max-width: 1024px) {
    .carousel-item {
      min-width: calc(90% / 2); /* Mostrar 2 imágenes en pantallas medianas */
    }
  }

  @media (min-width: 1024px) {
    .carousel-item {
      min-width: calc(90% / 3); /* Mostrar 3 imágenes en pantallas grandes */
    }
  }
</style>
